const knownRatios = {
	100: { numerator: 16, denominator: 15 },
	200: { numerator: 9, denominator: 8 },
	300: { numerator: 6, denominator: 5 },
	400: { numerator: 5, denominator: 4 },
	500: { numerator: 4, denominator: 3 },
};

// Cent mappings as provided earlier
export const centMappings = {
	0: 0,
	1: 1 / 200,
	2: 1 / 100,
	3: 3 / 200,
	4: 1 / 50,
	5: 1 / 40,
	6: 3 / 100,
	7: 7 / 200,
	8: 1 / 25,
	9: 9 / 200,
	10: 1 / 20,
	11: 11 / 200,
	12: 3 / 50,
	13: 13 / 200,
	14: 7 / 100,
	15: 3 / 40,
	16: 1 / 12,
	17: 1 / 12,
	18: 1 / 11,
	19: 1 / 11,
	20: 1 / 10,
	21: 21 / 200,
	22: 1 / 9,
	23: 1 / 9,
	24: 3 / 25,
	25: 1 / 8,
	26: 13 / 100,
	27: 27 / 200,
	28: 1 / 7,
	29: 1 / 7,
	30: 3 / 20,
	31: 31 / 200,
	32: 8 / 50,
	33: 1 / 6,
	34: 1 / 6,
	35: 7 / 40,
	36: 3 / 25,
	37: 3 / 25,
	38: 19 / 100,
	39: 19 / 100,
	40: 1 / 5,
	41: 1 / 5,
	42: 21 / 100,
	43: 21 / 100,
	44: 11 / 50,
	45: 11 / 50,
	46: 23 / 100,
	47: 23 / 100,
	48: 6 / 25,
	49: 6 / 25,
	50: 1 / 4,
	51: 1 / 4,
	52: 13 / 50,
	53: 13 / 50,
	54: 27 / 100,
	55: 27 / 100,
	56: 14 / 50,
	57: 14 / 50,
	58: 29 / 100,
	59: 29 / 100,
	60: 3 / 10,
	61: 3 / 10,
	62: 31 / 100,
	63: 31 / 100,
	64: 16 / 50,
	65: 16 / 50,
	66: 1 / 3,
	67: 1 / 3,
	68: 17 / 50,
	69: 17 / 50,
	70: 7 / 20,
	71: 7 / 20,
	72: 18 / 50,
	73: 18 / 50,
	74: 37 / 100,
	75: 37 / 100,
	76: 19 / 50,
	77: 19 / 50,
	78: 39 / 100,
	79: 39 / 100,
	80: 2 / 5,
	81: 2 / 5,
	82: 41 / 100,
	83: 41 / 100,
	84: 21 / 50,
	85: 21 / 50,
	86: 43 / 100,
	87: 43 / 100,
	88: 22 / 50,
	89: 22 / 50,
	90: 9 / 20,
	91: 9 / 20,
	92: 23 / 50,
	93: 23 / 50,
	94: 47 / 100,
	95: 47 / 100,
	96: 24 / 50,
	97: 24 / 50,
	98: 49 / 100,
	99: 49 / 100,
	100: 1 / 2,
	101: 1 / 2,
	102: 51 / 100,
	103: 51 / 100,
	104: 26 / 50,
	105: 26 / 50,
	106: 53 / 100,
	107: 53 / 100,
	108: 27 / 50,
	109: 27 / 50,
	110: 11 / 20,
	111: 11 / 20,
	112: 28 / 50,
	113: 28 / 50,
	114: 57 / 100,
	115: 57 / 100,
	116: 29 / 50,
	117: 29 / 50,
	118: 59 / 100,
	119: 59 / 100,
	120: 3 / 5,
	121: 3 / 5,
	122: 61 / 100,
	123: 61 / 100,
	124: 31 / 50,
	125: 31 / 50,
	126: 63 / 100,
	127: 63 / 100,
	128: 32 / 50,
	129: 32 / 50,
	130: 13 / 20,
	131: 13 / 20,
	132: 33 / 50,
	133: 33 / 50,
	134: 67 / 100,
	135: 67 / 100,
	136: 34 / 50,
	137: 34 / 50,
	138: 69 / 100,
	139: 69 / 100,
	140: 7 / 10,
	141: 7 / 10,
	142: 5 / 7,
	143: 5 / 7,
	144: 36 / 50,
	145: 36 / 50,
	146: 73 / 100,
	147: 73 / 100,
	148: 37 / 50,
	149: 37 / 50,
	150: 3 / 4,
	151: 3 / 4,
	152: 38 / 50,
	153: 38 / 50,
	154: 77 / 100,
	155: 77 / 100,
	156: 7 / 9,
	157: 7 / 9,
	158: 79 / 100,
	159: 79 / 100,
	160: 4 / 5,
	161: 4 / 5,
	162: 81 / 100,
	163: 81 / 100,
	164: 41 / 50,
	165: 41 / 50,
	166: 5 / 6,
	167: 5 / 6,
	168: 42 / 50,
	169: 42 / 50,
	170: 17 / 20,
	171: 17 / 20,
	172: 43 / 50,
	173: 43 / 50,
	174: 87 / 100,
	175: 87 / 100,
	176: 44 / 50,
	177: 44 / 50,
	178: 8 / 9,
	179: 8 / 9,
	180: 9 / 10,
	181: 9 / 10,
	182: 91 / 100,
	183: 91 / 100,
	184: 46 / 50,
	185: 46 / 50,
	186: 93 / 100,
	187: 93 / 100,
	188: 47 / 50,
	189: 47 / 50,
	190: 19 / 20,
	191: 19 / 20,
	192: 48 / 50,
	193: 48 / 50,
	194: 97 / 100,
	195: 97 / 100,
	196: 49 / 50,
	197: 49 / 50,
	198: 99 / 100,
	199: 99 / 100,
	200: 1,
};

// Helper function to approximate a fraction
export function approximateFraction(decimal, maxDenominator = 1000) {
	let bestNumerator = 1;
	let bestDenominator = 1;
	let bestError = Math.abs(decimal - bestNumerator / bestDenominator);

	for (let denominator = 1; denominator <= maxDenominator; denominator++) {
		const numerator = Math.round(decimal * denominator);
		const error = Math.abs(decimal - numerator / denominator);

		if (error < bestError) {
			bestNumerator = numerator;
			bestDenominator = denominator;
			bestError = error;
		}
	}

	return { numerator: bestNumerator, denominator: bestDenominator };
}

export function ratio(cents) {
	// If the cents value matches a known ratio, return it directly
	if (knownRatios[cents]) {
		const { numerator, denominator } = knownRatios[cents];
		return `${numerator}:${denominator}`;
	} else {
		// Otherwise, calculate the ratio using 12-TET formula
		const ratio = Math.pow(2, 200 * centMappings[cents % 200] / 1200);
		const fraction = approximateFraction(ratio);

		// Return the ratio as a fraction
		return `${fraction.numerator}:${fraction.denominator}`;
	}
}
